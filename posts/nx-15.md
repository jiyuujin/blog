---
layout: Article.tsx
publish_date: 2022-10-25
title: 'Nx v15 ã«æ›´æ–°ã™ã‚‹'
description: 'å…ˆæ—¥ Nx v15 ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸã®ã§ã€ãã®è©³ç´°ã«ã¤ã„ã¦ã‹ã„ã¤ã¾ã‚“ã§æ›¸ã‹ã›ã¦ã„ãŸã ã„ã¦ã„ã¾ã™ã€‚'
slug: nx-15
reaction: ğŸ¿
category: Server
tags:
  - Monorepo
  - Nx
---

ãªã«ã‹ã¨ãŠã—ã”ã¨ã®å ´é¢ã‚’ä¸­å¿ƒã«ã€æœ€è¿‘ Nx ã¸è§¦ã‚Œã‚‹æ©Ÿä¼šãŒå¤šã€…å­˜åœ¨ã—ã¦ãŠã‚Šã€å…ˆæ—¥ãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸ v15 ã«ã¤ã„ã¦æ›¸ã‹ã›ã¦ã„ãŸã ãã¾ã—ãŸã€‚

## Nx v15

å…ˆæ—¥ Nx v15 ãŒ [ãƒªãƒªãƒ¼ã‚¹](https://blog.nrwl.io/whats-new-in-nx-15-7e14e1ff282d) ã•ã‚Œã¾ã—ãŸã€‚

https://blog.nrwl.io/whats-new-in-nx-15-7e14e1ff282d

æ‰‹å…ƒã® Nx ç’°å¢ƒã‚’ v15 ã«æ›´æ–°ã™ã‚‹å ´åˆã¯ã€ã¾ãš `npx nx migrate` ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

ä¾å­˜é–¢ä¿‚ã‚’å–ã‚Šè¾¼ã‚“ã å¾Œã« `npx nx migrate --run-migrations` ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ Nx v15 ã¸ã®æ›´æ–°ã‚’å®Œäº†ã•ã›ã‚‰ã‚Œã¾ã™ã€‚

```bash
# npx nx migrate
npx nx migrate 15

npm i

# npx nx migrate --run-migrations
npx nx migrate --run-migrations
```

yarn ã‚’ãŠä½¿ã„ã®æ–¹ã¯ã€é©å®œèª­ã¿æ›¿ãˆã¦ãã ã•ã„ã€‚

åŸºæœ¬çš„ã«ã“ã‚Œã ã‘ã§å®Œäº†ã•ã›ã‚‰ã‚Œã¾ã™ã€‚

ç¶šã„ã¦ Nx v15 ã®ä¸»ãªç‰¹é•·ã‚’ä¸‹ã«ç¤ºã—ã¾ã™ã€‚

- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ”¹å–„
- ã‚¿ã‚¹ã‚¯ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§æ–°ã—ã„æ§‹æ–‡
- ESBuild ã‚µãƒãƒ¼ãƒˆ
- Cypress v10 ã‚µãƒãƒ¼ãƒˆ
- Nx Graph

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ”¹å–„

https://twitter.com/victorsavkin/status/1580283233916186624

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Describing things clearly is hard. <br><br>We spent the whole morning refining 2 options shown in a prompt. We examined every word, the symmetry of the options, how abstract they are, how they relate to our docs, to the language of other tools.<br><br>A lot of work but the result is good.</p>&mdash; Victor Savkin (@victorsavkin) <a href="https://twitter.com/victorsavkin/status/1580283233916186624?ref_src=twsrc%5Etfw">October 12, 2022</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

2 ã¤ã®æ–°ã—ã„ [ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ™ãƒ¼ã‚¹](https://nx.dev/getting-started/package-based-repo-tutorial) ã® [çµ±åˆã‚¹ã‚¿ã‚¤ãƒ« ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«](https://nx.dev/getting-started/integrated-repo-tutorial) ã«åŠ ãˆ 2 ã¤ã®å…¨ãæ–°ã—ã„ä½œã‚Šç›´ã•ã‚ŒãŸãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚‚ã‚ã‚Šã¾ã™ã€‚

- https://nx.dev/getting-started/react-tutorial
- https://nx.dev/getting-started/node-tutorial

### ã‚¿ã‚¹ã‚¯ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§æ–°ã—ã„æ§‹æ–‡

nx.json ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æŒ‡å®šã§ã€ç°¡å˜ã« `targetDefaults` ã‚’å®šç¾©ã§ãã¾ã™ã€‚è©³ç´°ã¯ã€æ˜¯é [Task Pipeline Configuration](https://nx.dev/concepts/task-pipeline-configuration) ã‚’ã”ç¢ºèªã„ãŸã ã‘ã‚Œã°å¹¸ã„ã§ã™ã€‚

```json
{
  "targetDefaults": {
    // æœ€åˆã«å…¨ã¦ã®ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹
    "build": {
      "dependsOn": ["^build"]
    },
    "dev": {
      "dependsOn": ["^build"]
    },
    // publish ã‚’å®Ÿè¡Œã™ã‚‹å‰ã«ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹
    "publish": {
      "dependsOn": ["^build"]
    }
  }
}
```

ã¾ãŸ `@nrwl/workspace:run-commands` ã¨ã—ã¦æ›¸ã‹ã‚Œã¦ã„ã‚‹è¡¨è¨˜ã‚’ `nx:run-commands` ã«æ›¸ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã¡ã‚‰ `@nrwl/workspace:run-commands` ã¯ Nx v16 ã§ deprecated ã€€ã®æ‰±ã„ã¨ãªã‚Šã¾ã™ã€‚

ã“ã†ã„ã£ãŸå¤‰æ›´ç‚¹ã‚‚ã‚ã‚Šã¾ã™ã€æ—¥å¸¸çš„ã« project ã‚³ãƒãƒ³ãƒ‰ã§å®Ÿè¡Œã—ãŸéš›åãå‡ºã•ã‚Œã‚‹ warning ã‚¨ãƒ©ãƒ¼ã«æ°—ã‚’ã¤ã‘ã¦ãŠãã¾ã—ã‚‡ã†ã€‚

### ESBuild ã‚µãƒãƒ¼ãƒˆ

JavaScript / TypeScript ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒåˆç†åŒ–ã•ã‚Œã¾ã—ãŸã€‚

ä»Šå›ã¯ ESBuild å°‚ç”¨ãƒãƒ³ãƒ‰ãƒ©ã‚’ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

- nrwl/webpack
- nrwl/rollup
- nrwl/esbuild -> new

æ–°ãŸã« local generator ã‚’ä½¿ç”¨ã—ã¦ nrwl/js:lib ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”Ÿæˆã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

### Cypress v10 ã‚µãƒãƒ¼ãƒˆ

æ—¢å­˜ã® Cypress ã‚’ v10 (æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³) ã«ç§»è¡Œã§ãã¾ã™ã€‚

```bash
# @nrwl/cypress to v10
npx nx g @nrwl/cypress:migrate-to-cypress-10
```

### Nx Graph

[Nx Graph](https://nx.dev/core-features/explore-graph) ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¾ãŸã¯ VS Code å†…ã§ç›´æ¥ã€è¦–è¦šåŒ–ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

```bash
# nx graph
nx graph
```

å·¦ãƒšã‚¤ãƒ³ã«[Show all projects]ãŒã‚ã‚Šã¾ã™ã€‚

ãã‚Œã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å…¨ä½“åƒã‚’å¯è¦–åŒ–ã§ãã¾ã™ã€‚

![](https://i.imgur.com/YkMJm33.png)
